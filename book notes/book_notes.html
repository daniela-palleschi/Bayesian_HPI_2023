<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Daniela Palleschi">

<title>Chapter notes</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>


<script src="book_notes_files/libs/clipboard/clipboard.min.js"></script>
<script src="book_notes_files/libs/quarto-html/quarto.js"></script>
<script src="book_notes_files/libs/quarto-html/popper.min.js"></script>
<script src="book_notes_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="book_notes_files/libs/quarto-html/anchor.min.js"></script>
<link href="book_notes_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="book_notes_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="book_notes_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="book_notes_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="book_notes_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css">

<link rel="stylesheet" href="styles.css">
</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#set-up" id="toc-set-up" class="nav-link active" data-scroll-target="#set-up">Set up</a></li>
  <li><a href="#ch.-1---intro" id="toc-ch.-1---intro" class="nav-link" data-scroll-target="#ch.-1---intro"><span class="toc-section-number">1</span>  Ch. 1 - Intro</a>
  <ul class="collapse">
  <li><a href="#probability" id="toc-probability" class="nav-link" data-scroll-target="#probability"><span class="toc-section-number">1.1</span>  Probability</a>
  <ul class="collapse">
  <li><a href="#conditional-probability-and-bayes-rule" id="toc-conditional-probability-and-bayes-rule" class="nav-link" data-scroll-target="#conditional-probability-and-bayes-rule"><span class="toc-section-number">1.1.1</span>  Conditional probability and Bayes’ rule</a></li>
  <li><a href="#law-of-total-probability" id="toc-law-of-total-probability" class="nav-link" data-scroll-target="#law-of-total-probability"><span class="toc-section-number">1.1.2</span>  Law of total probability</a></li>
  </ul></li>
  <li><a href="#discrete-random-variables" id="toc-discrete-random-variables" class="nav-link" data-scroll-target="#discrete-random-variables"><span class="toc-section-number">1.2</span>  Discrete random variables</a>
  <ul class="collapse">
  <li><a href="#the-mean-and-variance-of-the-binomial-distribution" id="toc-the-mean-and-variance-of-the-binomial-distribution" class="nav-link" data-scroll-target="#the-mean-and-variance-of-the-binomial-distribution"><span class="toc-section-number">1.2.1</span>  The mean and variance of the binomial distribution</a></li>
  <li><a href="#compute-probability-of-a-particular-outcome-discrete-dibinom" id="toc-compute-probability-of-a-particular-outcome-discrete-dibinom" class="nav-link" data-scroll-target="#compute-probability-of-a-particular-outcome-discrete-dibinom"><span class="toc-section-number">1.2.2</span>  Compute probability of a particular outcome (discrete): dibinom</a></li>
  <li><a href="#compute-cumulative-probability-pbinom" id="toc-compute-cumulative-probability-pbinom" class="nav-link" data-scroll-target="#compute-cumulative-probability-pbinom"><span class="toc-section-number">1.2.3</span>  Compute cumulative probability: pbinom</a></li>
  <li><a href="#compute-the-inverse-of-the-cdf-quantile-function-qbinom" id="toc-compute-the-inverse-of-the-cdf-quantile-function-qbinom" class="nav-link" data-scroll-target="#compute-the-inverse-of-the-cdf-quantile-function-qbinom"><span class="toc-section-number">1.2.4</span>  Compute the inverse of the CDF (quantile function): qbinom</a></li>
  </ul></li>
  <li><a href="#continuous-random-variables" id="toc-continuous-random-variables" class="nav-link" data-scroll-target="#continuous-random-variables"><span class="toc-section-number">1.3</span>  Continuous random variables</a>
  <ul class="collapse">
  <li><a href="#an-important-distinction-probability-vs.-densitiy-in-continuous-random-variables" id="toc-an-important-distinction-probability-vs.-densitiy-in-continuous-random-variables" class="nav-link" data-scroll-target="#an-important-distinction-probability-vs.-densitiy-in-continuous-random-variables"><span class="toc-section-number">1.3.1</span>  An important distinction: probability vs.&nbsp;densitiy in continuous random variables</a></li>
  <li><a href="#truncating-a-normal-distribution" id="toc-truncating-a-normal-distribution" class="nav-link" data-scroll-target="#truncating-a-normal-distribution"><span class="toc-section-number">1.3.2</span>  Truncating a normal distribution</a></li>
  </ul></li>
  <li><a href="#bivariate-and-multivariate-distributions" id="toc-bivariate-and-multivariate-distributions" class="nav-link" data-scroll-target="#bivariate-and-multivariate-distributions"><span class="toc-section-number">1.4</span>  Bivariate and multivariate distributions</a>
  <ul class="collapse">
  <li><a href="#generate-simulated-bivariate-multivariate-data" id="toc-generate-simulated-bivariate-multivariate-data" class="nav-link" data-scroll-target="#generate-simulated-bivariate-multivariate-data"><span class="toc-section-number">1.4.1</span>  Generate simulated bivariate (multivariate) data</a></li>
  </ul></li>
  <li><a href="#an-important-concept-the-marginal-likelihood-integrating-out-a-parameter" id="toc-an-important-concept-the-marginal-likelihood-integrating-out-a-parameter" class="nav-link" data-scroll-target="#an-important-concept-the-marginal-likelihood-integrating-out-a-parameter"><span class="toc-section-number">1.5</span>  An important concept: the marginal likelihood (integrating out a parameter)</a></li>
  <li><a href="#exercises" id="toc-exercises" class="nav-link" data-scroll-target="#exercises"><span class="toc-section-number">1.6</span>  Exercises</a></li>
  </ul></li>
  <li><a href="#ch.-2---intro-to-bayesian-data-analysis" id="toc-ch.-2---intro-to-bayesian-data-analysis" class="nav-link" data-scroll-target="#ch.-2---intro-to-bayesian-data-analysis"><span class="toc-section-number">2</span>  Ch. 2 - Intro to Bayesian data analysis</a>
  <ul class="collapse">
  <li><a href="#terms" id="toc-terms" class="nav-link" data-scroll-target="#terms">Terms</a></li>
  <li><a href="#bayes-rule" id="toc-bayes-rule" class="nav-link" data-scroll-target="#bayes-rule"><span class="toc-section-number">2.1</span>  Bayes’ Rule</a></li>
  <li><a href="#deriving-the-posterior-using-bayes-rule-an-analystical-example" id="toc-deriving-the-posterior-using-bayes-rule-an-analystical-example" class="nav-link" data-scroll-target="#deriving-the-posterior-using-bayes-rule-an-analystical-example"><span class="toc-section-number">2.2</span>  Deriving the posterior using Bayes’ Rule: an analystical example</a></li>
  <li><a href="#choosing-a-likelihood" id="toc-choosing-a-likelihood" class="nav-link" data-scroll-target="#choosing-a-likelihood"><span class="toc-section-number">2.3</span>  Choosing a likelihood</a></li>
  <li><a href="#choosinga-a-prior-for-theta" id="toc-choosinga-a-prior-for-theta" class="nav-link" data-scroll-target="#choosinga-a-prior-for-theta"><span class="toc-section-number">2.4</span>  Choosinga a prior for <span class="math inline">\theta</span></a></li>
  <li><a href="#using-bayes-rule-to-computer-the-posterior-pthetank" id="toc-using-bayes-rule-to-computer-the-posterior-pthetank" class="nav-link" data-scroll-target="#using-bayes-rule-to-computer-the-posterior-pthetank"><span class="toc-section-number">2.5</span>  Using Baye’s rule to computer the posterior <em>p(</em><span class="math inline">\theta</span><em>|n,k)</em></a></li>
  <li><a href="#summary-of-the-procedure" id="toc-summary-of-the-procedure" class="nav-link" data-scroll-target="#summary-of-the-procedure"><span class="toc-section-number">2.6</span>  Summary of the procedure</a></li>
  <li><a href="#visualising-the-prior-likelihood-and-the-posterior" id="toc-visualising-the-prior-likelihood-and-the-posterior" class="nav-link" data-scroll-target="#visualising-the-prior-likelihood-and-the-posterior"><span class="toc-section-number">2.7</span>  Visualising the prior, likelihood, and the posterior</a></li>
  <li><a href="#the-posterior-distribution-is-ac-ompromise-between-the-prior-and-the-likelihood" id="toc-the-posterior-distribution-is-ac-ompromise-between-the-prior-and-the-likelihood" class="nav-link" data-scroll-target="#the-posterior-distribution-is-ac-ompromise-between-the-prior-and-the-likelihood"><span class="toc-section-number">2.8</span>  The posterior distribution is ac ompromise between the prior and the likelihood</a></li>
  <li><a href="#incremental-knowledge-gain-using-prior-knowledge" id="toc-incremental-knowledge-gain-using-prior-knowledge" class="nav-link" data-scroll-target="#incremental-knowledge-gain-using-prior-knowledge"><span class="toc-section-number">2.9</span>  Incremental knowledge gain using prior knowledge</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Chapter notes</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Daniela Palleschi </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<p>These notes are based on <span class="citation" data-cites="nicenboim_introduction_nodate">Nicenboim, Schad, and Vasishth (<a href="#ref-nicenboim_introduction_nodate" role="doc-biblioref">n.d.</a>)</span>, both from a PDF version supplied by the authors and the html version available <a href="https://vasishth.github.io/bayescogsci/book/">here</a> (accessed in early 2023). Much of the notes are taken verbatim from the book, as are code snippets.</p>
<div id="refs" class="references csl-bib-body hanging-indent" data-custom-style="Bibliography" role="doc-bibliography">
<div id="ref-nicenboim_introduction_nodate" class="csl-entry" role="doc-biblioentry">
Nicenboim, Bruno, Daniel Schad, and Shravan Vasishth. n.d. <span>“An Introduction to Bayesian Data Analysis for Cognitive Science.”</span>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>Wrote 1 reference to './references.json'</code></pre>
</div>
</div>
<section id="set-up" class="level1 unnumbered">
<h1 class="unnumbered">Set up</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># suppress scientific notation</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">scipen=</span><span class="dv">999</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># load packages</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="do">## create list of package names</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>packages <span class="ot">&lt;-</span> <span class="fu">c</span>( <span class="co">#"SIN", # this package was removed from the CRAN repository</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>               <span class="st">"MASS"</span>, <span class="st">"dplyr"</span>, <span class="st">"tidyr"</span>, <span class="st">"purrr"</span>, <span class="st">"extraDistr"</span>, <span class="st">"ggplot2"</span>, <span class="st">"loo"</span>, <span class="st">"bridgesampling"</span>, <span class="st">"brms"</span>, <span class="st">"bayesplot"</span>, <span class="st">"tictoc"</span>, <span class="st">"hypr"</span>, <span class="st">"bcogsci"</span>, <span class="st">"papaja"</span>, <span class="st">"grid"</span>, <span class="st">"kableExtra"</span>, <span class="st">"gridExtra"</span>, <span class="st">"lme4"</span>, <span class="st">"cowplot"</span>, <span class="st">"pdftools"</span>, <span class="st">"cmdstanr"</span>, <span class="st">"rootSolve"</span>, <span class="st">"rstan"</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="co"># NB: if you haven't already installed bcogsci through devtools, it won't be loaded</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="do">## Now load or install &amp; load all</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>package.check <span class="ot">&lt;-</span> <span class="fu">lapply</span>(</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>  packages,</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">FUN =</span> <span class="cf">function</span>(x) {</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(x, <span class="at">character.only =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>      <span class="fu">install.packages</span>(x, <span class="at">dependencies =</span> <span class="cn">TRUE</span>)</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>      <span class="fu">library</span>(x, <span class="at">character.only =</span> <span class="cn">TRUE</span>)</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a><span class="co"># this is also required, taken from the textbook</span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a><span class="do">## Save compiled models:</span></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a><span class="fu">rstan_options</span>(<span class="at">auto_write =</span> <span class="cn">FALSE</span>)</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a><span class="do">## Parallelize the chains using all the cores:</span></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">mc.cores =</span> parallel<span class="sc">::</span><span class="fu">detectCores</span>())</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a><span class="co"># To solve some conflicts between packages</span></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>select <span class="ot">&lt;-</span> dplyr<span class="sc">::</span>select</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>extract <span class="ot">&lt;-</span> rstan<span class="sc">::</span>extract</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="ch.-1---intro" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Ch. 1 - Intro</h1>
<ul>
<li>given some data, how to use Bayes’ theorem to <strong><em>quantify uncertainty about our belief</em></strong> regarding a scientific question of interest</li>
<li>topics to be understood:
<ul>
<li>the basic concepts behind probability</li>
<li>the concept of random variables</li>
<li>probability distributions</li>
<li>the concept of likelihood</li>
</ul></li>
</ul>
<section id="probability" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="probability"><span class="header-section-number">1.1</span> Probability</h2>
<p>Frequency-based versus uncertain-belief perspective of probability:</p>
<ol type="1">
<li>repeatable events, like rolling a die and getting a 6, are <em>frequentist</em> because <strong>probability</strong> is related to the <em>frequency</em> at which we’d observe an outcome given repeated observations</li>
<li>one-of-a-kind events, like earthquakes, don’t work with this idea of probability</li>
</ol>
<ul>
<li>the probability of an earthquake expresses our <em>uncertainty</em> about an event happening</li>
<li>we also be <em>uncertain</em> about how probable an event is: being 90% sure something is 50% likely to happen</li>
<li>this is what we’re interested in: how uncertain we are of an estimate</li>
</ul>
<p>In Bayesian analysis, we want to express our uncertainty about the probability of observing an outcome (<em>prior distribution</em>).</p>
<section id="conditional-probability-and-bayes-rule" class="level3" data-number="1.1.1">
<h3 data-number="1.1.1" class="anchored" data-anchor-id="conditional-probability-and-bayes-rule"><span class="header-section-number">1.1.1</span> Conditional probability and Bayes’ rule</h3>
<ul>
<li>A = “the streets are wet”</li>
<li>B = “it was raining”</li>
<li>P(A|B) = the probability of A given B</li>
<li>P(A,B) = P(A|B)P(B) (the probability of A and B happening)</li>
</ul>
</section>
<section id="law-of-total-probability" class="level3" data-number="1.1.2">
<h3 data-number="1.1.2" class="anchored" data-anchor-id="law-of-total-probability"><span class="header-section-number">1.1.2</span> Law of total probability</h3>
<ul>
<li>dunno</li>
</ul>
</section>
</section>
<section id="discrete-random-variables" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="discrete-random-variables"><span class="header-section-number">1.2</span> Discrete random variables</h2>
<p>Generating random sequences of simulated data with a binomial distribution. Imagine a cloze task, where we consider a particular word a success (1) and any other word a failure (0). If we run the experiment 20 times with a sample size of 10, the cloze probabilities for these 20 experiments would be:</p>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rbinom</span>(<span class="dv">10</span>, <span class="at">n =</span> <span class="dv">20</span>, <span class="at">prob =</span> .<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>[1] 4 4 5 4 4 5 2 3 5 2 4 2 6 5 5 2 6 5 5 7</p>
<p>For discrete random variables such as the binomial, the probability distribution <em>p(y|<span class="math inline">\theta</span>)</em> is called a probability mass function (PMF) . The PMF defines the probability of each possible outcome. With <em>n</em> = 10 trials, there are 11 possible outcomes (0, 1, 2,…10 succeses). Which outcome is most probable depends on the parameter <span class="math inline">\theta</span> that represents the probability of success. Above, we set <span class="math inline">\theta</span> to <code>0.5</code>.</p>
<section id="the-mean-and-variance-of-the-binomial-distribution" class="level3" data-number="1.2.1">
<h3 data-number="1.2.1" class="anchored" data-anchor-id="the-mean-and-variance-of-the-binomial-distribution"><span class="header-section-number">1.2.1</span> The mean and variance of the binomial distribution</h3>
<p>In real exerimental situations we never know the true value of <span class="math inline">\theta</span> (probability of an outcome), but it can be derived from the data: <em><span class="math inline">\theta</span> hat = k/n</em>, where <em>k</em> = number of observed successess, <em>n</em> = number of trials, and <em><span class="math inline">\theta</span> hat</em> = observed proportion of successes. <em><span class="math inline">\theta</span> hat</em> = <strong><em>maximum likelihood estimate</em></strong> of the true but unknown parameter <em><span class="math inline">\theta</span></em>. Basically, the <strong>mean</strong> of the binomial distribution. The <strong>variance</strong> can also be estimated by computing <em>(n(<span class="math inline">\theta</span>))(1 - <span class="math inline">\theta</span>)</em>. These estimates can be be used for statistical inference.</p>
</section>
<section id="compute-probability-of-a-particular-outcome-discrete-dibinom" class="level3" data-number="1.2.2">
<h3 data-number="1.2.2" class="anchored" data-anchor-id="compute-probability-of-a-particular-outcome-discrete-dibinom"><span class="header-section-number">1.2.2</span> Compute probability of a particular outcome (discrete): dibinom</h3>
<p><code>dbinom</code> calculates probability of <em>k</em> successes out of <em>n</em> given a particular <em><span class="math inline">\theta</span></em>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dbinom</span>(<span class="dv">5</span>, <span class="at">size =</span> <span class="dv">10</span>, <span class="at">prob =</span> .<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2460938</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dbinom</span>(<span class="dv">5</span>, <span class="at">size =</span> <span class="dv">10</span>, <span class="at">prob =</span> .<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.001488035</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dbinom</span>(<span class="dv">5</span>, <span class="at">size =</span> <span class="dv">10</span>, <span class="at">prob =</span> .<span class="dv">9</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.001488035</code></pre>
</div>
</div>
<p>With continuous data, the probability of obtaining an exact value will always be zero. We’ll come ot this later.</p>
</section>
<section id="compute-cumulative-probability-pbinom" class="level3" data-number="1.2.3">
<h3 data-number="1.2.3" class="anchored" data-anchor-id="compute-cumulative-probability-pbinom"><span class="header-section-number">1.2.3</span> Compute cumulative probability: pbinom</h3>
<p>The cumulative distribution function (CDF): essentially the sum of all probabilities of the values of <em>k</em> you are interested in. E.g., the probability of observing 2 successes or fewer (0, 1, or 2) is:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># sum of probabilities for exact k's</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dbinom</span>(<span class="dv">0</span>, <span class="at">size =</span> <span class="dv">10</span>, <span class="at">prob =</span> .<span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dbinom</span>(<span class="dv">1</span>, <span class="at">size =</span> <span class="dv">10</span>, <span class="at">prob =</span> .<span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dbinom</span>(<span class="dv">2</span>, <span class="at">size =</span> <span class="dv">10</span>, <span class="at">prob =</span> .<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0546875</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># or</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">dbinom</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">size =</span> <span class="dv">10</span>, <span class="at">prob =</span> .<span class="dv">5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0546875</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># or use pbinom()</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pbinom</span>(<span class="dv">2</span>, <span class="at">size =</span> <span class="dv">10</span>, <span class="at">prob =</span> <span class="fl">0.5</span>, <span class="at">lower.tail =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0546875</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># conversely, what is the $\theta$ of observing THREE successes or more?</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pbinom</span>(<span class="dv">2</span>, <span class="at">size =</span> <span class="dv">10</span>, <span class="at">prob =</span> <span class="fl">0.5</span>, <span class="at">lower.tail =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9453125</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># or</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">dbinom</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">10</span>, <span class="at">size =</span> <span class="dv">10</span>, <span class="at">prob =</span> .<span class="dv">5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9453125</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># the probability of observing 10 or fewer successes (out of 10 trials)</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pbinom</span>(<span class="dv">10</span>, <span class="at">size =</span> <span class="dv">10</span>, <span class="at">prob =</span> <span class="fl">0.5</span>, <span class="at">lower.tail =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1</code></pre>
</div>
</div>
</section>
<section id="compute-the-inverse-of-the-cdf-quantile-function-qbinom" class="level3" data-number="1.2.4">
<h3 data-number="1.2.4" class="anchored" data-anchor-id="compute-the-inverse-of-the-cdf-quantile-function-qbinom"><span class="header-section-number">1.2.4</span> Compute the inverse of the CDF (quantile function): qbinom</h3>
<p>The quantile function (the inverse CDF) obtains the value of <em>k</em> (the quantile) given the probability of obtaining <em>k</em> or less than <em>k</em> successes given some specific probability value <em>p</em>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># reverse of dbinom(2,10,.5) would be:</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qbinom</span>(<span class="fl">0.0546875</span>, <span class="at">size=</span><span class="dv">10</span>, <span class="at">prob=</span>.<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2</code></pre>
</div>
</div>
<section id="generage-simulated-data-from-binomial-distribtion-rbinom" class="level4">
<h4 class="anchored" data-anchor-id="generage-simulated-data-from-binomial-distribtion-rbinom">Generage simulated data from binomial distribtion: rbinom</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># given 1 iteration of 10 trials where p = .5, produce a random value of k</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="dv">10</span>, .<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 9</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="continuous-random-variables" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="continuous-random-variables"><span class="header-section-number">1.3</span> Continuous random variables</h2>
<p>Imagine vector of reading times data with a normal distribution, defined by its <em>mean</em> and its <em>sd</em>. The <strong><em>probability density function</em></strong> (PDF) for particular values of mean and sd (assuming a normal distribution) can be calculated using <code>dnorm</code>. The CDF can be found using <code>pnorm</code>, and the inverse CDF using <code>qnorm</code>. These are 3 different ways of looking at the infrmation.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># p of observing a mean of 250ms when the true mean is 500 &amp; sd = 100 (PDF)</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dnorm</span>(<span class="dv">400</span>,<span class="at">mean =</span> <span class="dv">500</span>, <span class="at">sd =</span> <span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.002419707</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># p of observing 400ms *or lower* when the true mean is 500 &amp; sd = 100 (CDF)</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pnorm</span>(<span class="dv">400</span>,<span class="at">mean =</span> <span class="dv">500</span>, <span class="at">sd =</span> <span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1586553</code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># k with a CDF of 0.1586553 when the true mean is 500 &amp; sd = 100 (inverse CDF)</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qnorm</span>(<span class="fl">0.1586553</span>, <span class="at">mean =</span> <span class="dv">500</span>, <span class="at">sd =</span> <span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 400</code></pre>
</div>
</div>
<p>Question: what is the probability of observing values between 200 and 700 from a normal distribution where mean = 500 and sd = 100?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pnorm</span>(<span class="dv">700</span>,<span class="dv">500</span>,<span class="dv">100</span>) <span class="sc">-</span> <span class="fu">pnorm</span>(<span class="dv">200</span>,<span class="dv">500</span>,<span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9759</code></pre>
</div>
</div>
<p>With continuous data, it is only meaningful to ask about probabilities between two point values (e.g., probability that Y lies between a and b).</p>
<p>What is the quantile <em>q</em> such that the probability of observing that value or something less (or more) than it is 0.975 (given the normal(500,100) distribution)?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qnorm</span>(<span class="fl">0.975</span>, <span class="at">m=</span><span class="dv">500</span>, <span class="at">sd=</span><span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 695.9964</code></pre>
</div>
</div>
<p>Next task: generate simulated data. generate 10 data points using the <code>rnorm</code> function and use this simulated data to compute the mean and stanrdard devaition.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">10</span>,<span class="dv">500</span>,<span class="dv">100</span>)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 550.3463</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 79.05702</code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># can also computer lower and upper bounds of 95% CIs</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(x, <span class="at">probs =</span> <span class="fu">c</span>(.<span class="dv">025</span>, .<span class="dv">975</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    2.5%    97.5% 
448.1318 682.3570 </code></pre>
</div>
</div>
<section id="an-important-distinction-probability-vs.-densitiy-in-continuous-random-variables" class="level3" data-number="1.3.1">
<h3 data-number="1.3.1" class="anchored" data-anchor-id="an-important-distinction-probability-vs.-densitiy-in-continuous-random-variables"><span class="header-section-number">1.3.1</span> An important distinction: probability vs.&nbsp;densitiy in continuous random variables</h3>
<p>The probability density function (PDF):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># density with default m = 0 and sd = 1</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dnorm</span>(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2419707</code></pre>
</div>
</div>
<p>This is not the probability of observing 1 in this distribution, as the probability of a single value in a continous distribtion will always be 0. This is becaue probability in a continuous distritubion is the <strong><em>area under the curve</em></strong>, and at a single point there is no area under the curve (i.e., p = 0). The <code>pnorm</code> function allows us to find the cumulative distribution function (CDF) for the normal distribution.</p>
<p>For example, the probability of obseving a value etween +/-2 in a normal distribution with mean 0 and sd 1:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pnorm</span>(<span class="dv">2</span>, <span class="at">m =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>) <span class="sc">-</span> <span class="fu">pnorm</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="at">m =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9544997</code></pre>
</div>
</div>
<p>For <strong><em>discrete</em></strong> random variables, the situation is different. These have a probability <strong>mass</strong> function (PMF), the binomial distribution that we saw before. Here, the PMF maps the possible <em>y</em> values to the probabilities of those exact values occurring.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dbinom</span>(<span class="dv">2</span>,<span class="at">size=</span><span class="dv">10</span>,<span class="at">prob=</span>.<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.04394531</code></pre>
</div>
</div>
</section>
<section id="truncating-a-normal-distribution" class="level3" data-number="1.3.2">
<h3 data-number="1.3.2" class="anchored" data-anchor-id="truncating-a-normal-distribution"><span class="header-section-number">1.3.2</span> Truncating a normal distribution</h3>
<p>Refers to positive values only (truncating at 0).</p>
</section>
</section>
<section id="bivariate-and-multivariate-distributions" class="level2" data-number="1.4">
<h2 data-number="1.4" class="anchored" data-anchor-id="bivariate-and-multivariate-distributions"><span class="header-section-number">1.4</span> Bivariate and multivariate distributions</h2>
<p>Consider a case where two discrete responses were recorded: a binary yes/no response, and a Likert acceptability rating (1-7).</p>
<p>The <strong><em>joint probability mass function</em></strong> is the joint PMF of two random variables.</p>
<p>Let’s play around with some such data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># run if package is not loaded</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="co"># library(bcogsci)</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"df_discreteagrmt"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="marginal-distributions" class="level4">
<h4 class="anchored" data-anchor-id="marginal-distributions">Marginal distributions</h4>
<p>The marginal distribution of each pair of values (let’s say <em>x</em> = the binary response, <em>y</em> = the Likert response) is computed by summing up</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rowSums</span>(probs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong><em>object <code>probs</code> is not defined in the book</em></strong></p>
</section>
<section id="generate-simulated-bivariate-multivariate-data" class="level3" data-number="1.4.1">
<h3 data-number="1.4.1" class="anchored" data-anchor-id="generate-simulated-bivariate-multivariate-data"><span class="header-section-number">1.4.1</span> Generate simulated bivariate (multivariate) data</h3>
<p>Suppose we want to generate 100 pairs of correlated data, with correlation rho = 0.6. The two random variables have mean 0, and standard deviations 5 and 10 respectively.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="do">## define a variance-covariance matrix:</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>Sigma <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">5</span><span class="sc">^</span><span class="dv">2</span>, <span class="dv">5</span> <span class="sc">*</span> <span class="dv">10</span> <span class="sc">*</span> .<span class="dv">6</span>, <span class="dv">5</span> <span class="sc">*</span> <span class="dv">10</span> <span class="sc">*</span> .<span class="dv">6</span>, <span class="dv">10</span><span class="sc">^</span><span class="dv">2</span>),</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">byrow =</span> <span class="cn">FALSE</span>, <span class="at">ncol =</span> <span class="dv">2</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a><span class="do">## generate data:</span></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">n =</span> <span class="dv">100</span>,</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">mu =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">Sigma =</span> Sigma</span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(u, <span class="at">n =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           [,1]       [,2]
[1,] -0.8268538  -3.240125
[2,] -2.9766580 -17.185101
[3,] -5.2277669 -12.007005</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the data</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">tibble</span>(<span class="at">u_1 =</span> u[, <span class="dv">1</span>], <span class="at">u_2 =</span> u[, <span class="dv">2</span>]), <span class="fu">aes</span>(u_1, u_2)) <span class="sc">+</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="book_notes_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="an-important-concept-the-marginal-likelihood-integrating-out-a-parameter" class="level2" data-number="1.5">
<h2 data-number="1.5" class="anchored" data-anchor-id="an-important-concept-the-marginal-likelihood-integrating-out-a-parameter"><span class="header-section-number">1.5</span> An important concept: the marginal likelihood (integrating out a parameter)</h2>
</section>
<section id="exercises" class="level2" data-number="1.6">
<h2 data-number="1.6" class="anchored" data-anchor-id="exercises"><span class="header-section-number">1.6</span> Exercises</h2>
<p>1.1 Practice with pnorm Part 1</p>
<p>Given a normal distribution with mean 500 and standard deviation 100, use the pnorm function to calculate the probability of obtaining values between 200 and 800 from this distribution.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pnorm</span>(<span class="dv">800</span>, <span class="at">mean =</span> <span class="dv">500</span>, <span class="at">sd =</span> <span class="dv">100</span>) <span class="sc">-</span> <span class="fu">pnorm</span>(<span class="dv">200</span>, <span class="at">mean =</span> <span class="dv">500</span>, <span class="at">sd =</span> <span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9973002</code></pre>
</div>
</div>
<p>1.2 Practice with pnorm Part 2</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pnorm</span>(<span class="dv">700</span>, <span class="dv">800</span>, <span class="dv">150</span>, <span class="at">lower.tail=</span>T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2524925</code></pre>
</div>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pnorm</span>(<span class="dv">900</span>, <span class="dv">800</span>, <span class="dv">150</span>, <span class="at">lower.tail=</span>F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2524925</code></pre>
</div>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pnorm</span>(<span class="dv">800</span>, <span class="dv">800</span>, <span class="dv">150</span>, <span class="at">lower.tail=</span>F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5</code></pre>
</div>
</div>
<p>1.3 Practice with pnorm Part 3</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pnorm</span>(<span class="dv">550</span>,<span class="dv">600</span>,<span class="dv">200</span>,<span class="at">lower.tail=</span>T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4012937</code></pre>
</div>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pnorm</span>(<span class="dv">800</span>,<span class="dv">600</span>,<span class="dv">200</span>,<span class="at">lower.tail=</span>T) <span class="sc">-</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pnorm</span>(<span class="dv">300</span>,<span class="dv">600</span>,<span class="dv">200</span>,<span class="at">lower.tail=</span>T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7745375</code></pre>
</div>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pnorm</span>(<span class="dv">900</span>,<span class="dv">600</span>,<span class="dv">200</span>,<span class="at">lower.tail=</span>F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0668072</code></pre>
</div>
</div>
<p>Exercise 1.4 Practice using the qnorm function - Part 1</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qnorm</span>(<span class="fu">c</span>(.<span class="dv">1</span>,.<span class="dv">9</span>),<span class="at">mean=</span><span class="dv">1</span>,<span class="at">sd=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.2815516  2.2815516</code></pre>
</div>
</div>
<p>Exercise 1.5 Practice using the qnorm function - Part 2</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qnorm</span>(<span class="fu">c</span>(.<span class="dv">1</span>,.<span class="dv">9</span>), <span class="at">mean=</span><span class="dv">650</span>, <span class="at">sd=</span><span class="dv">125</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 489.8061 810.1939</code></pre>
</div>
</div>
<p>Exercise 1.6 Practice getting summaries from samples - Part 1</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>data_gen1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>, <span class="dv">300</span>, <span class="dv">200</span>)</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a><span class="co"># mean</span></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(data_gen1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 300.7989</code></pre>
</div>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># sd</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(data_gen1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 206.6333</code></pre>
</div>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co"># q1 and q2</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qnorm</span>(<span class="fu">c</span>(.<span class="dv">1</span>,.<span class="dv">9</span>), <span class="fu">mean</span>(data_gen1), <span class="fu">sd</span>(data_gen1))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  35.9877 565.6102</code></pre>
</div>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(data_gen1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="book_notes_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Exercise 1.7 Practice getting summaries from samples - Part 2</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co"># generate data with truncated normal distribution</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>data_gen1 <span class="ot">&lt;-</span> <span class="fu">rtnorm</span>(<span class="dv">1000</span>, <span class="dv">300</span>, <span class="dv">200</span>, <span class="at">a =</span> <span class="dv">0</span>)</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a><span class="co"># mean</span></span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(data_gen1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 331.0684</code></pre>
</div>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co"># sd</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(data_gen1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 179.3631</code></pre>
</div>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co"># q1 and q2</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qnorm</span>(<span class="fu">c</span>(.<span class="dv">1</span>,.<span class="dv">9</span>), <span class="fu">mean</span>(data_gen1), <span class="fu">sd</span>(data_gen1))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 101.2053 560.9314</code></pre>
</div>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(data_gen1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="book_notes_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Exercise 1.8 Practice with a variance-covariance matrix for a bivariate distribution</p>
</section>
</section>
<section id="ch.-2---intro-to-bayesian-data-analysis" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Ch. 2 - Intro to Bayesian data analysis</h1>
<ul>
<li>simple but crucial point: the posterior distribution of a parameter is a compromise between the prior and the likelihood</li>
</ul>
<section id="terms" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="terms">Terms</h2>
<ul>
<li><em>posterior</em>, <em>p(</em>$theta$<em>|y)</em>: probability distribution of the parameters conditional on the <strong>data</strong></li>
<li><em>likelihood</em>, <em>p(y|</em>$theta$<em>)</em>: the PMF or PDF expressed as a function of <span class="math inline">\theta</span></li>
<li><em>prior</em>, $theta$: the initial probability distribution of paramters <strong><em>before seeing the data</em></strong></li>
<li><em>marginal likelihood, p(y)</em>: standardizes the posterior distribution to ensure the AUC sums to 1; it ensure the posterior is a valid probability distribution</li>
</ul>
</section>
<section id="bayes-rule" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="bayes-rule"><span class="header-section-number">2.1</span> Bayes’ Rule</h2>
<ul>
<li>Bayes’ rule: when <em>A</em> and <em>B</em> are observable discrete events (like “it has been raining” or “the streets are wet”), we can state the rule as follows:</li>
</ul>
<p><span class="math display">\begin{equation}
P(A\mid B) = \frac{P(B\mid A) P(A)}{P(B)}
\tag{2.1}
\end{equation}</span></p>
<ul>
<li>given a vector of data <em>y</em>, we can work out the posterior distributions of parameters of interest which we represent as the vector of parameters <span class="math inline">\theta</span></li>
<li>to do this, we can re-write equation 2.1 as 2.2:</li>
</ul>
<p><span class="math display">\begin{equation}
p(\boldsymbol{\Theta}|\boldsymbol{y}) = \cfrac{ p(\boldsymbol{y}|\boldsymbol{\Theta}) \cdot p(\boldsymbol{\Theta}) }{p(\boldsymbol{y})}
\tag{2.2}
\end{equation}</span></p>
<ul>
<li>now, Bayes’ rule is writen in terms of probability distributions, where p() is the probability density function (continuous) or probability mass function (discrete)</li>
<li>in words, this simply means:</li>
</ul>
<p><span class="math display">\begin{equation}
\hbox{Posterior} = \frac{\hbox{Likelihood} \cdot \hbox{Prior}}{\hbox{Marginal Likelihood}}
\end{equation}</span></p>
</section>
<section id="deriving-the-posterior-using-bayes-rule-an-analystical-example" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="deriving-the-posterior-using-bayes-rule-an-analystical-example"><span class="header-section-number">2.2</span> Deriving the posterior using Bayes’ Rule: an analystical example</h2>
<ul>
<li><p>participants are shown sentences like <em>It’s raining. I’m going to take the…</em></p></li>
<li><p>if 100 participants complete the sentence, and 80 complete the sentence with <em>bus</em>, the estimated cloze probability would be <span class="math inline">\frac{80}{100}</span>=0.8</p>
<ul>
<li>this is the <strong>maximum likelihood estimate</strong> of the probability of producing the word; as this is an estimate let’s add a hat: <span class="math inline">\hat \theta</span>=0.8</li>
</ul></li>
<li><p>in the frequentist paradigm, <span class="math inline">\hat \theta</span>=0.8 is an estimate of an <strong>unknown point value</strong> <span class="math inline">\theta</span> “out there in nature”</p></li>
<li><p>N.B., the variability in the estimate will be influenced by the sample size</p>
<ul>
<li>if the <em>true</em> value of <span class="math inline">\theta</span> is really 0.80, we will still get some variability in the estimated proportion from a sample size of say 10 pariticpants</li>
<li>let’s carry out 100 simulated experiments and compute their variability:</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>estimated_means <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="at">n =</span> <span class="dv">100</span>, <span class="co"># generate 100 random binomial data sets</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>                          <span class="at">size =</span> <span class="dv">10</span>, <span class="co"># of 10 obvs each</span></span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">prob =</span> .<span class="dv">8</span>) <span class="sc">/</span> <span class="dv">10</span> <span class="co"># with prob 8, now divide these by 10 to get 100 means (k/n)</span></span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a><span class="co"># what is the sd of these 100 means?</span></span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">sd</span>(estimated_means),<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.133</code></pre>
</div>
</div>
<ul>
<li>instead, let’s imagine that <span class="math inline">\theta</span> is a <strong><em>random variable</em></strong>; i.e., it has a PDF associated with it
<ul>
<li>this PDDF would now represent our <strong><em>belief</em></strong> about possible values of <span class="math inline">\theta</span> <em>before we have any data</em></li>
<li>e.g., if we believe from the outset that all possible values between 0 and 1 are equally likely, we would have a uniform prior of <span class="math inline">\theta \sim \mathit{Uniform}</span>(0,1)</li>
<li>let’s re-run our simulated experiments, but with <em>two</em> sources of variability: the data and our uncertainty associated with <span class="math inline">\theta</span></li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>theta <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">100</span>, <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="dv">1</span>) <span class="co"># simulate 100 numbers between 0:1</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>estimated_means <span class="ot">&lt;-</span> <span class="fu">rbinom</span>( <span class="co"># generate random binomial data that has...</span></span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">n =</span> <span class="dv">100</span>, <span class="co"># 100x</span></span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">size =</span> <span class="dv">10</span>, <span class="co"># of 10 obvs</span></span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">prob =</span> theta <span class="co"># with prob = theta</span></span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a>)<span class="sc">/</span><span class="dv">10</span> <span class="co"># divided by 10 to give us the mean for each</span></span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a><span class="co"># sd of the means from these 100 'experiments'</span></span>
<span id="cb87-10"><a href="#cb87-10" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">sd</span>(estimated_means),<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.304</code></pre>
</div>
</div>
<ul>
<li>the higher standard deviation, representing variability int he estimate of the parameter, comes frm the added uncertainty from the <span class="math inline">\theta</span> parameter
<ul>
<li>what would happen if we had tighter expectations, i.e., a very tight PDF for <span class="math inline">\theta</span>, say (0.7,0.9)?</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>theta <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">100</span>, <span class="at">min =</span> <span class="fl">0.7</span>, <span class="at">max =</span> <span class="fl">0.9</span>) <span class="co"># simulate 100 numbers between 0:1</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>estimated_means <span class="ot">&lt;-</span> <span class="fu">rbinom</span>( <span class="co"># generate random binomial data that has...</span></span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">n =</span> <span class="dv">100</span>, <span class="co"># 100x</span></span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">size =</span> <span class="dv">10</span>, <span class="co"># of 10 obvs</span></span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">prob =</span> theta <span class="co"># with prob = theta</span></span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a>)<span class="sc">/</span><span class="dv">10</span> <span class="co"># divided by 10 to give us the mean for each</span></span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true" tabindex="-1"></a><span class="co"># sd of the means from these 100 'experiments'</span></span>
<span id="cb89-10"><a href="#cb89-10" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">sd</span>(estimated_means),<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.137</code></pre>
</div>
</div>
<ul>
<li><p>the variability is smaller; so the greater the uncertainty associated with the <span class="math inline">\theta</span> parameter, the greater the variability in the data</p></li>
<li><p>this is very different from the frequentist assumption that <span class="math inline">\theta</span> is a point value; in Bayesian <span class="math inline">\theta</span> is a <strong>random variable</strong> with a probability density/mass function associated with it</p></li>
<li><p>this PDF is called a <strong>prior distribution</strong> and represents our prior belief or knowledge about a possible value of this parameter</p></li>
<li><p>once we obtain data, these data serve to modify our prior belief about the distribution, called our <strong>posterior distribution</strong></p></li>
</ul>
</section>
<section id="choosing-a-likelihood" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="choosing-a-likelihood"><span class="header-section-number">2.3</span> Choosing a likelihood</h2>
<ul>
<li>with a binomial distribution like the cloze probability (chose ‘bus’ or not), the PMF can be written as:</li>
</ul>
<p><span class="math display">\begin{equation}
p(k|n,\theta) = \binom{n}
{k} \theta^k (1-\theta)^{n-k}
\tag{2.3}
\end{equation}</span></p>
<ul>
<li><em>k</em> = the number of times “bus” was given as an answer</li>
<li><em>n</em> = the total number of answers given</li>
<li>if we collect 100 data points (<em>n</em> = 100), and find <em>k</em> = 80, we now have 2 fixed data points, <em>n</em> and <em>k</em>. The only variable is now <span class="math inline">\theta</span></li>
</ul>
<p><span class="math display">\begin{equation}
p(k=80 | n= 100,  \theta) = \binom{n}{k} \theta^{80} (1-\theta)^{20}
\end{equation}</span></p>
<ul>
<li><p>this is now a continuous function of the value of <span class="math inline">\theta</span>, which can have a possible value between 0 and 1</p></li>
<li><p>by contrast, the PMF of the binomial treats <span class="math inline">\theta</span> as a <strong>fixed</strong> value and defines a discrete distribution over the n+1 possible discrete values <em>k</em> that we can observe</p></li>
<li><p>recall: the PMF and the likelihood are the same function seen from different points of view: the only difference being what is considered fixed (PMF: <span class="math inline">\theta</span>, likelihood: data) and what is varying (PMF: data, likelihood: <span class="math inline">\theta</span>)</p>
<ul>
<li><strong>PMF</strong>: <span class="math inline">\theta</span> is fixed, data varies</li>
<li><strong>likelihood function</strong>: data is fixed, <span class="math inline">\theta</span> varies</li>
</ul></li>
</ul>
<p>Now we go back to our main foal: using Bayes’ rule to find out the posterior distribution of <span class="math inline">\theta</span> given our data: <em>p(</em><span class="math inline">\theta</span>*|n,k). We first need to define a prior distribution over the parameter <span class="math inline">theta</span>, thereby expressing our prior uncertainty about plausible values of <span class="math inline">\theta</span></p>
</section>
<section id="choosinga-a-prior-for-theta" class="level2" data-number="2.4">
<h2 data-number="2.4" class="anchored" data-anchor-id="choosinga-a-prior-for-theta"><span class="header-section-number">2.4</span> Choosinga a prior for <span class="math inline">\theta</span></h2>
<ul>
<li><p>priors for a <span class="math inline">\theta</span> in a binominal distribution: the parameter <span class="math inline">\theta</span> is a random variable with a PDF whose range is [0,1]</p></li>
<li><p>the <strong><em>beta distribution</em></strong>, which is a PDF for a continuous random variable, is commonly used as a prior for parameters representing probabilities, and has the following PDF:</p></li>
</ul>
<p><span class="math display">\begin{equation}
p(\theta|a,b)=  \frac{1}{B(a,b)} \theta^{a - 1} (1-\theta)^{b-1}   
\tag{2.4}
\end{equation}</span></p>
<ul>
<li><em>B(a,b)</em> is a normalising constant that ensures that the area under the curve sums to 1, so that <em>p(</em><span class="math inline">\theta</span>|<em>a,b)</em> is a probability</li>
<li>the beta distribution’s paramters <em>a</em> and <em>b</em> express our prior beliefs about the probability of a success:
<ul>
<li><em>a</em> = number of “successes” (answering “bus”)</li>
<li><em>b</em> = number of “failures” (not answering “bus”)</li>
</ul></li>
<li>the different beta distributions shapes given different values of a and b are shown below (in r, a = <code>shape1</code> and b = <code>shape2</code>)</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="cf">function</span>(x) </span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dbeta</span>(x,<span class="at">shape1=</span><span class="dv">1</span>,<span class="at">shape2=</span><span class="dv">1</span>), <span class="dv">0</span>,<span class="dv">1</span>,</span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">main =</span> <span class="st">"Beta density"</span>,</span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab=</span><span class="st">"density"</span>,<span class="at">xlab=</span><span class="st">"theta"</span>,<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">3</span>))</span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(.<span class="dv">5</span>,<span class="fl">1.1</span>,<span class="st">"a=1,b=1"</span>)</span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="cf">function</span>(x) </span>
<span id="cb91-9"><a href="#cb91-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dbeta</span>(x,<span class="at">shape1=</span><span class="dv">3</span>,<span class="at">shape2=</span><span class="dv">3</span>),<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">add=</span><span class="cn">TRUE</span>)</span>
<span id="cb91-10"><a href="#cb91-10" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(.<span class="dv">5</span>,<span class="fl">1.6</span>,<span class="st">"a=3,b=3"</span>)</span>
<span id="cb91-11"><a href="#cb91-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-12"><a href="#cb91-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-13"><a href="#cb91-13" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="cf">function</span>(x) </span>
<span id="cb91-14"><a href="#cb91-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dbeta</span>(x,<span class="at">shape1=</span><span class="dv">6</span>,<span class="at">shape2=</span><span class="dv">6</span>),<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">add=</span><span class="cn">TRUE</span>)</span>
<span id="cb91-15"><a href="#cb91-15" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(.<span class="dv">5</span>,<span class="fl">2.8</span>,<span class="st">"a=6,b=6"</span>)</span>
<span id="cb91-16"><a href="#cb91-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-17"><a href="#cb91-17" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="cf">function</span>(x) </span>
<span id="cb91-18"><a href="#cb91-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dbeta</span>(x,<span class="at">shape1=</span><span class="dv">2</span>,<span class="at">shape2=</span><span class="dv">6</span>),<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">add=</span><span class="cn">TRUE</span>)</span>
<span id="cb91-19"><a href="#cb91-19" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(.<span class="dv">15</span>,<span class="fl">2.9</span>,<span class="st">"a=2,b=6"</span>)</span>
<span id="cb91-20"><a href="#cb91-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-21"><a href="#cb91-21" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="cf">function</span>(x) </span>
<span id="cb91-22"><a href="#cb91-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dbeta</span>(x,<span class="at">shape1=</span><span class="dv">6</span>,<span class="at">shape2=</span><span class="dv">2</span>),<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">add=</span><span class="cn">TRUE</span>)</span>
<span id="cb91-23"><a href="#cb91-23" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(.<span class="dv">85</span>,<span class="fl">2.9</span>,<span class="st">"a=6,b=2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="book_notes_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<ul>
<li>to express our uncertainty, we could compute 95% <strong><em>credible</em></strong> intervales, i.e., the region over which we are 95% certain the value of the parameter lies</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compute 95% CrIs</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(</span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">qbeta</span>(<span class="co"># at what quantiles (points on the x-axis)</span></span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(.<span class="dv">025</span>,.<span class="dv">975</span>), <span class="co"># would the PDF cover 95% AUC</span></span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">shape1 =</span> <span class="dv">4</span>, <span class="co"># where a = 4</span></span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">shape2 =</span> <span class="dv">4</span>), <span class="co"># and b = 4</span></span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a>  <span class="dv">3</span>) <span class="co"># rounded to 3 decimal points</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.184 0.816</code></pre>
</div>
</div>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Sidebar
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>in a unimodal distribution, one could use the narrowest interval that contains the mode (the <strong>highest posterior density interval</strong> (HDI))</li>
<li>in skewed posterior distirbutions, the equal-tailed CrI and the HDI will not be identical, because the HDI will have unequal tail probabilities; this book uses the equal-tailed interval (like we computed above) because it’s the standard output in <code>Stan</code> and <code>brms</code></li>
</ul>
</div>
</div>
<ul>
<li>if we were to choose <em>a</em> = 10 and <em>b</em> = 10, we would still be assuming a prior that “bus” is just as likely as some other word, but now our prior uncertainty about this mean is lower, meaning we have a tighter prior:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compute 95% CrIs</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(</span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">qbeta</span>(<span class="co"># at what quantiles (points on the x-axis)</span></span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(.<span class="dv">025</span>,.<span class="dv">975</span>), <span class="co"># would the PDF cover 95% AUC</span></span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">shape1 =</span> <span class="dv">10</span>, <span class="co"># where a = 4</span></span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">shape2 =</span> <span class="dv">10</span>), <span class="co"># and b = 4</span></span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a>  <span class="dv">3</span>) <span class="co"># rounded to 3 decimal points</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.289 0.711</code></pre>
</div>
</div>
<ul>
<li>compare the AUC for the two beta distributions in</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="cf">function</span>(x) </span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dbeta</span>(x,<span class="at">shape1=</span><span class="dv">4</span>,<span class="at">shape2=</span><span class="dv">4</span>), <span class="dv">0</span>,<span class="dv">1</span>,</span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">main =</span> <span class="st">"Beta density"</span>,</span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab=</span><span class="st">"density"</span>,<span class="at">xlab=</span><span class="st">"theta"</span>,<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">4</span>))</span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(.<span class="dv">5</span>,<span class="fl">2.35</span>,<span class="st">"a=4,b=4"</span>)</span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="cf">function</span>(x) </span>
<span id="cb96-8"><a href="#cb96-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dbeta</span>(x,<span class="at">shape1=</span><span class="dv">10</span>,<span class="at">shape2=</span><span class="dv">10</span>),<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">add=</span><span class="cn">TRUE</span>,</span>
<span id="cb96-9"><a href="#cb96-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab=</span><span class="st">"density"</span>,<span class="at">xlab=</span><span class="st">"theta"</span>,<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">4</span>))</span>
<span id="cb96-10"><a href="#cb96-10" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(.<span class="dv">5</span>,<span class="fl">3.7</span>,<span class="st">"a=10,b=10"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-beta2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="book_notes_files/figure-html/fig-beta2-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;1: Beta distributions with varying a and b values</figcaption><p></p>
</figure>
</div>
</div>
</div>
<ul>
<li>but which prior should we choose? This depends on our prior knowledge
<ul>
<li>if we don’t have much prior information, we could use <em>a</em> = <em>b</em> = 1; this is a uniform prior <span class="math inline">\mathit{Uniform}</span>(0,1), often clled a <strong><em>flat</em></strong>, <strong><em>non-informative</em></strong>, or <strong><em>uninformative prior</em></strong></li>
<li>if we have a lot of prior knowledge or a strong belief regarding the range of plausible values for <span class="math inline">\theta</span>, we can use a different set of <em>a</em> and <em>b</em> values</li>
<li>if we were to use <em>a</em> = 4 and <em>b</em> = 4, then our prior for <span class="math inline">\theta</span> would be:</li>
</ul></li>
</ul>
<p><span class="math display">\begin{equation}
p(\theta) = \frac{1}{B(4,4)} \theta^{3} (1-\theta)^{3}
\end{equation}</span></p>
</section>
<section id="using-bayes-rule-to-computer-the-posterior-pthetank" class="level2" data-number="2.5">
<h2 data-number="2.5" class="anchored" data-anchor-id="using-bayes-rule-to-computer-the-posterior-pthetank"><span class="header-section-number">2.5</span> Using Baye’s rule to computer the posterior <em>p(</em><span class="math inline">\theta</span><em>|n,k)</em></h2>
</section>
<section id="summary-of-the-procedure" class="level2" data-number="2.6">
<h2 data-number="2.6" class="anchored" data-anchor-id="summary-of-the-procedure"><span class="header-section-number">2.6</span> Summary of the procedure</h2>
</section>
<section id="visualising-the-prior-likelihood-and-the-posterior" class="level2" data-number="2.7">
<h2 data-number="2.7" class="anchored" data-anchor-id="visualising-the-prior-likelihood-and-the-posterior"><span class="header-section-number">2.7</span> Visualising the prior, likelihood, and the posterior</h2>
</section>
<section id="the-posterior-distribution-is-ac-ompromise-between-the-prior-and-the-likelihood" class="level2" data-number="2.8">
<h2 data-number="2.8" class="anchored" data-anchor-id="the-posterior-distribution-is-ac-ompromise-between-the-prior-and-the-likelihood"><span class="header-section-number">2.8</span> The posterior distribution is ac ompromise between the prior and the likelihood</h2>
</section>
<section id="incremental-knowledge-gain-using-prior-knowledge" class="level2" data-number="2.9">
<h2 data-number="2.9" class="anchored" data-anchor-id="incremental-knowledge-gain-using-prior-knowledge"><span class="header-section-number">2.9</span> Incremental knowledge gain using prior knowledge</h2>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>